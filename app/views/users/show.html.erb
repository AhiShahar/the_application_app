<% if flash[:error] %>
<%= flash[:error] %>
<% end %>

<h2><%= @user.first_name %>'s Profile</h2>

<div class="row">
    <div class="col s12 m3">
        <% if @user == @current_user %>
        <h5>Customer List</h5>
        <% @user.approved_customers.each do |c| %>
        <p><%= c.customer.first_name %></p>
        <% end %>
        <% end %>
    </div>
    <div class="col s12 m6">
        <% unless @current_user.present? && @current_user.is_approved_customer?( @user.id ) %>
        <%= link_to "Register to Professional", new_relation_path( @user ) %>
        <% end %>
        <br>
        <ul>
            <li><%= @user.last_name %>,
                <%= @user.first_name %></li>
            <br>
            <li><%= @user.email %></li>
            <br>
            <% if @current_user.present? && @current_user.is_approved_customer?( @user.id ) %>
            <li><%= @user.phone %></li>
            <% end %>
        </ul>

        <% if @current_user.present? && @current_user.is_approved_customer?( @user.id ) %>
        <% @user.meetings.each do |app| %>
        <%=link_to app.start_time, edit_appointment_path(app) %>
        <br>
        <% end %>
        <% if @current_user.id == params[:id].to_i %>
        <div class="controls">
            <%= link_to "Create Appointment", new_appointment_path %>
            |
            <%= link_to "Edit Details", edit_user_path %>
            |
            <%= link_to "Delete Account", user_path(@user), :method => :delete, :data => { :confirm => "Are you sure?" } %>
        </div>
        <% end %>
        <% end %>

    </div>
    <div class="col s12 m3">
        <% if @user == @current_user %>
        <h5>Pending Customers</h5>
        <% @user.unapproved_customers.each do |c| %>
        <p><%= link_to c.customer.first_name, approve_relation_path %></p>
        <% end %>
        <% end %>
    </div>

</div>
